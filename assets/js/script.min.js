function on(a,b,c,d){if(!a.length)return"#document-fragment"===a.nodeName?void on(a.childNodes,b,c,d):("function"==typeof Application.Events.list[b]?Application.Events.list[b](a,function(){return function(a){c(a,d)}}(c,d)):isset(a.addEventListener)?a.addEventListener(b,function(){return function(a){c(a,d)}}(c,d),!1):a.attachEvent("on"+b,function(){return function(a){c(a,d)}}(c,d)),a);for(var e=0;e<a.length;e++)on(a[e],b,c,d)}function $(a){"function"==typeof a&&Application.dom_load_event_listeners.push(a)}function child_node_list(a){for(var b=[],c=0;c<a.childNodes.length;c++)if(b.push(a.childNodes[c]),a.childNodes[c].childNodes)for(var d=child_node_list(a.childNodes[c]),e=0;e<d.length;e++)b.push(d[e]);return b}function complete_vars(a,b,c){if(add=c?c+".":"",b instanceof Array)for(var d=0,e=b.length;e>d;d++)a=b[d]instanceof Object?a.complete(b[d],add+d):a.replace("${"+add+d+"}",b[d]);else if(b instanceof Object)for(var d in b)a=b.hasOwnProperty(d)&&b[d]instanceof Object?a.complete(b[d],add+d):a.replace("${"+add+d+"}",b[d]);return a}function isset(a){return"undefined"!=typeof a}function Element(a,b){if(this!==window)var c=Element.create(a,b);else var c=Element.select(a,b);return c.childs=c.childNodes,c.parent=c.parentNode,c.clone=c.cloneNode,c.add=function(a){return function(b){if("#document-fragment"===b.nodeName){for(var c=[],d=b.childNodes,e=d.length,f=0;e>f;f++)a.appendChild(d[0]),c.push(a.childNodes[a.childNodes.length-1]);return c}if(!b.length)return a.appendChild(b),El(b);for(var f=0;f<b.length;f++){for(var c=[],e=b.length,f=0;e>f;f++)a.appendChild(b[0]),c.push(a.childNodes[a.childNodes.length-1]);return c}}}(c),c.add_first=function(a){return function(b){if("#document-fragment"===b.nodeName){for(var c=[],d=b.childNodes,e=d.length,f=0;e>f;f++)a.insertBefore(d[0],a.firstChild),c.push(a.childNodes[a.childNodes.length-1]);return c}if(!b.length)return a.insertBefore(b,a.firstChild),El(b);for(var f=0;f<b.length;f++){for(var c=[],e=b.length,f=0;e>f;f++)a.insertBefore(b[0],a.firstChild),c.push(a.childNodes[a.childNodes.length-1]);return c}}}(c),c.on=function(a){return function(b,c,d){on(a,b,c,d)}}(c),c.offset=function(a){return function(){for(var b={x:0,y:0};a;)b.x+=a.offsetLeft-(a==document.body?0:a.scrollLeft)+a.clientLeft,b.y+=a.offsetTop-(a==document.body?0:a.scrollTop)+a.clientTop,a=a.offsetParent;return b}}(c),c.has_class=function(a){return function(b){return(" "+a.className+" ").indexOf(" "+b+" ")>-1}}(c),c.add_class=function(a){return function(b){return El(a).has_class(b)||(a.className+=" "+b),El(a)}}(c),c.remove_class=function(a){return function(b){return a.className=(" "+a.className+" ").replace(" "+b+" "," "),El(a)}}(c),c.toogle_class=function(a){return function(b){return El(a).has_class(b)?El(a).remove_class(b):El(a).add_class(b),El(a)}}(c),c.is_disabled=function(a){return function(){return El(a).has_class("disabled")}}(c),c.is_not_disabled=function(a){return function(){return!El(a).has_class("disabled")}}(c),c.disable=function(a){return function(){return a.tabIndex=0,El(a).add_class("disabled")}}(c),c.undisable=function(a){return function(){return a.tabIndex=0,El(a).remove_class("disabled")}}(c),c.inner=function(a){var b=document.createElement("div");return b.setAttribute("tag-name","_inner_"),a.appendChild(b),a},c}function Component(a){this.name=a,Application.components[a]=this}function background_loader(a){this.element=El(a),this.src=this.element.getAttribute("data-background"),this.element.style.backgroundImage="url("+this.src+")",this.imgLoader=new Image,this.imgLoader.src=this.src,on(this.imgLoader,"load",function(a,b){b.remove_class("bg-loader"),b.add_class("bg-loader-transition"),b.add_class("bg-loaded"),setTimeout(function(a){return function(){a.remove_class("bg-loader-transition")}}(b),300)},a)}function postMessage(){marmottajax.post({url:"../../../posts",json:!0,options:{"post-message-submit":"lol",channel:El("#channel-social-message-submit").getAttribute("data-channel-id"),"post-content":El("#post-content").value}}).then(function(a){return function(b){El("#channel-posts").add_first(DOM('<channel-post avatar="${avatar}" channel="${channel}" message="${message}"/>',{avatar:_my_avatar_,channel:a,message:b.content}))}}(El("#channel-social-message-submit").getAttribute("data-channel-id"))),El("#post-content").value=""}function set_exporter_input_value(){if(!document.getElementById("exporter-input"))return!1;var a=El("#exporter-input"),b=El("#exporter-quality"),c=El("#exporter-autoplay"),d=El("#exporter-time-checkbox"),e=El("#exporter-time-input"),f="//dreamvids.fr/embed/"+_VIDEO_ID_,g=b.options[b.value].innerHTML||"640x360",h=g.split("x");width=h[0],height=h[1];var i=c.checked||!1;i&&(f+="/autoplay");var j=d.checked||!1;if(j)for(var k=e.value,l=k.split(":").reverse(),m=0;m<l.length;m++)f+=l[m]+"/";a.value='<iframe width="'+width+'" height="'+height+'" src="'+f+'" allowfullscreen frameborder="0"></iframe>'}var Application={name:"MarmWork"};Application.Events={list:{}},Application.Events.add=function(a,b){Application.Events.list[a]=b},Application.Events.on_tap_events_list=[],Application.Events.add("CLICK",function(a,b){var c=new Application.Events.on_tap_object(a,b);Application.Events.on_tap_events_list.push(c)}),Application.Events.on_tap_object=function(a,b){this.callback=b,this.element=a,this.touchstart=function(a){return function(b){a.moved=!1,a.startX=b.touches[0].clientX,a.startY=b.touches[0].clientY}}(this),this.touchmove=function(a){return function(b){(Math.abs(b.touches[0].clientX-a.startX)>10||Math.abs(b.touches[0].clientY-a.startY)>10)&&(a.moved=!0)}}(this),this.touchend=function(a){return function(b){a.moved||a.callback(b)}}(this),on(this.element,"touchstart",this.touchstart),on(this.element,"touchmove",this.touchmove),on(this.element,"touchend",this.touchend),on(this.element,"touchcancel",this.touchend),on(this.element,"click",function(a,b){"ontouchstart"in window||b.callback(a)},this)},Application.dom_load_event_listeners=[],Application.dom_content_loaded=!1,Application.on_dom_content_loaded=function(){if(!Application.dom_content_loaded){Application.dom_content_loaded=!0;for(var a=0;a<Application.dom_load_event_listeners.length;a++){var b=Application.dom_load_event_listeners[a];"function"==typeof b&&b()}}},on(document,"DOMContentLoaded",Application.on_dom_content_loaded),on(window,"load",Application.on_dom_content_loaded),window.onload=function(){Application.on_dom_content_loaded()};var marmottajax=function(a){return marmottajax.get(a)};marmottajax.normalize=function(a){return a?"string"==typeof a?{url:a}:a:null},marmottajax.json=function(a){return(a=marmottajax.normalize(a))?(a.json=!0,new marmottajax.request(a)):void 0},marmottajax.get=function(a){return new marmottajax.request(a)},marmottajax.post=function(a){return(a=marmottajax.normalize(a))?(a.method="POST",new marmottajax.request(a)):void 0},marmottajax.put=function(a){return(a=marmottajax.normalize(a))?(a.method="PUT",new marmottajax.request(a)):void 0},marmottajax.destroy=marmottajax.remove=marmottajax.delete_=function(a){return(a=marmottajax.normalize(a))?(a.method="DELETE",new marmottajax.request(a)):void 0},marmottajax.request=function(a){if(!a)return!1;if("string"==typeof a&&(a={url:a}),"POST"===a.method||"PUT"===a.method||"DELETE"===a.method){var b="?";for(var c in a.options)b+=a.options.hasOwnProperty(c)?"&"+c+"="+a.options[c]:""}else{a.method="GET",a.url+=a.url.indexOf("?")<0?"?":"";for(var c in a.options)a.url+=a.options.hasOwnProperty(c)?"&"+c+"="+a.options[c]:""}this.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.xhr.options=a,this.xhr.callbacks={then:[],error:[]},this.then=function(a){return this.xhr.callbacks.then.push(a),this},this.error=function(a){return this.xhr.callbacks.error.push(a),this},this.xhr.call=function(a,b){for(var c=0;c<this.callbacks[a].length;c++)"function"==typeof this.callbacks[a][c]&&this.callbacks[a][c](b)},this.xhr.onreadystatechange=function(){if(4===this.readyState&&200==this.status){var a=this.responseText;if(this.options.json)try{a=JSON.parse(a)}catch(b){return this.call("error","invalid json"),!1}this.call("then",a)}else 4===this.readyState&&404==this.status?this.call("error","404"):4===this.readyState&&this.call("error","unknow")},this.xhr.open(a.method,a.url,!0),this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xhr.send("undefined"!=typeof b?b:null)},$(function(){for(var a=0;a<Application.scripts.length;a++){var b=!1,c=Application.scripts[a];if("*"!==c.pages&&"all"!==c.pages&&c.pages)for(var d=0;d<c.pages.length;d++)c.pages[d]===_currentpage_&&(b=!0);else b=!0;b&&c.call()}}),Application.scripts=[];var Script=function(a){this.pages=a.pages,this.to_call=a.call,Application.scripts.push(this)};Script.prototype.call=function(){this.to_call()},Application.Element=Element;var El=Element;Element.create=function(a,b){var c,d=/\w+/.exec(a)[0];if(Application.components[d]){var e="object"==typeof b?b:{},f=Application.components[d].create(e);child.parentNode.insertBefore(f,child),child.parentNode.removeChild(child)}else c=document.createElement(d);var g=a.replace(/#([a-z-_]+)/i,"").replace(/\w+/,"").split(".");if(g.length>1){c.className="";for(var h=1;h<g.length;h++)c.className+=" "+g[h]}var i=/([a-z-_]+)(#([a-z-_]+))/i.exec(a);return i&&(c.id=i[3]),c},Element.select=function(a){var b;return"string"!=typeof a?b=a:"#"==a[0]&&(b=document.getElementById(a.substring(1))||new El("div")),b},Application.components={};var Co=Component;Application.Component=Component,Component.attributes_parser=function(a,b){for(var c={},d=0;d<a.length;d++)if(c[a[d].name]=a[d].value,"string"==typeof a[d].value&&"$"==a[d].value[0]&&b)for(parameter in b)a[d].value==="${"+parameter+"}"&&b.hasOwnProperty(parameter)&&(c[a[d].name]=b[parameter]);return c},Component.prototype.create=function(a){var b=Element(document.createDocumentFragment());this.render(b,a);var c=document.createElement("div");c.appendChild(b);var d=child_node_list(c);if(a._CHILDNODES_.length){for(var e=!1,f=0;f<d.length;f++){var g=d[f];if("_inner_"===g.getAttribute("tag-name")){for(var h=a._CHILDNODES_.length,f=0;h>f;f++)g.parentNode.insertBefore(a._CHILDNODES_[0],g);g.parentNode.removeChild(g),e=!0;break}}if(!e){console.error("L'intérieur du Component \""+this.name+"\" n'est pas défini.");for(var f=0;f<a._CHILDNODES_.length;f++)c.firstChild.appendChild(a._CHILDNODES_[f])}}for(var i=document.createDocumentFragment();c.childNodes.length;)i.appendChild(c.childNodes[0]);return i};var DOM=Component.generate=Component.gen=function(a,b){if("string"!=typeof a)return document.createElement("div");a=a.replace(/^\s+|\s+$/g,""),a=a.replace(/<([-\w]*)( (.+?))?\/>/g,"<$1$2></$1>"),a=a.replace(/<([-\w]*)( (.+?))?>/g,'<div tag-name="$1"$2>').replace(/<\/(.+?)>/g,"</div>"),console.log(a);var c=document.createElement("div");c.innerHTML=a;var d=!1,e=!1;for(loops=0;!d;){e=!1,loops++,loops>10&&(console.error("Une boucle de création de component a été détéctée"),d=!0);for(var f=child_node_list(c),g=0;g<f.length;g++){var h=f[g],i="";if(h.getAttribute&&(i=h.getAttribute("tag-name")||""),Application.components[i]){var j=Component.attributes_parser(h.attributes,b);j._CHILDNODES_=h.childNodes;var k=Application.components[i].create(j),l=k.firstChild;for(attribute in j)j.hasOwnProperty(attribute)&&null===l.getAttribute(attribute)&&"string"==typeof j[attribute]&&l.setAttribute(attribute,j[attribute]);l.removeAttribute("tag-name"),h.parentNode.insertBefore(k,h),h.parentNode.removeChild(h),e=!0;break}}e||(d=!0)}return c.childNodes};Component.inner=function(a){var b=document.createElement("div");return b.setAttribute("tag-name","_inner_"),a.appendChild(b),a};var c_btn=new Component("btn");c_btn.render=function(a,b){var c="raised"===b.type?"raised":"flat",d=b.color?".btn--"+b.color:"",e=b.outline?".btn--outline-"+b.outline:"",f=b.ripple?".btn--ripple-"+b.ripple:"",g=isset(b.disable)?".disabled":"",h=a.add(new Element("div.btn.btn--"+c+d+e+f+g));g||(h.tabIndex=0),a.inner(h),b.click&&on(h,"CLICK",b.click,h),b["no-ripple"]||El(h).add(DOM('<ripple parent="${parent}"/>',{parent:h}))};var c_card=new Component("card");c_card.render=function(a,b){var c=isset(b.type)?b.type:"video";if("video"===c){var d=a.add(new El("div.card.video")),e=d.add(new El("div.thumbnail"));e.style.backgroundImage="url("+b.thumbnail+")";var f=e.add(new El("div.time"));f.innerHTML=b.duration;var g=e.add(new El("a.overlay"));g.href="watch/"+b["vid-id"];var h=d.add(new El("div.description")),i=h.add(new El("a"));i.href="watch/"+b["vid-id"];var j=i.add(new El("h4"));j.innerHTML=b.title;var k=h.add(new El("div")),l=k.add(new El("div.view"));l.innerHTML=b.views;var m=k.add(new El("a.channel"));m.href="channel/"+b.channel,m.innerHTML=b["channel-name"]}else if("plus"==c){var d=a.add(new El("div.card.plus")),n=d.add(new El("a"));n.href="watch/"+b["vid-id"];var e=n.add(new El("div.thumbnail"));e.style.backgroundImage="url("+b.thumbnail+")";var o=n.add(new El("p")),p=o.add(new El("b"));p.innerHTML=b["channel-name"],o.innerHTML+=' a aimé votre vidéo "<b>'+b["vid-name"]+'</b>"';var q=d.add(new El("i"));q.innerHTML=b["relative-time"]}else if("comment"==c){var d=a.add(new El("div.card.comment")),n=d.add(new El("a"));n.href="watch/"+b["vid-id"];var o=n.add(new El("p")),p=o.add(new El("b"));p.innerHTML=b["channel-name"],o.innerHTML+=' a commenté votre vidéo "<b>'+b["vid-name"]+'</b>"';var r=n.add(new El("blockquote"));r.innerHTML=b.comment;var q=d.add(new El("i"));q.innerHTML=b["relative-time"]}else if("channel"==c){var d=a.add(new El("div.card.channel")),n=d.add(new El("a"));n.href="watch/"+b.channel;var s=n.add(new El("div.avatar"));s.style.backgroundImage="url("+b.avatar+")";var o=n.add(new El("p")),p=o.add(new El("b"));p.innerHTML=b["channel-name"],o.innerHTML+=" s'est abonné à votre chaîne \"<b>"+b["my-channel-name"]+'</b>"';var t=d.add(new El("span.subscribers"));t.innerHTML="<b>"+b.subscribers+"</b> Abonnés";var q=d.add(new El("i"));q.innerHTML=b["relative-time"]}a.inner(d),b.click&&on(btn,"CLICK",b.click,btn)};var c_channel_post=new Component("channel-post");c_channel_post.render=function(a,b){var c=a.add(new Element("div.channel-post")),d=c.add(new Element("img"));d.src=b.avatar;var e=c.add(new Element("p")),f=e.add(new Element("span.channel-name"));f.innerHTML=b.channel,e.innerHTML+=" a posté un message :";var g=c.add(new Element("div.social-message"));g.innerHTML=b.message,a.inner(c)};var c_ripple=new Component("ripple");c_ripple.render=function(a,b){var c=a.add(new Element("div.ripple"));a.inner(c),b.parent&&on(b.parent,"mousedown",function(a,b){var c=b.ripple,d=b.parent;if(El(d).is_not_disabled()){var e=c.add(new El("div.ripple__circle.ripple__circle--animate")),f=El(d).offset(),g=a.changedTouches?a.changedTouches[0].pageX:a.pageX,h=a.changedTouches?a.changedTouches[0].pageY:a.pageY;e.style.left=g-f.x+"px",e.style.top=h-f.y+"px"}},{ripple:c,parent:b.parent})},new Script({call:function(){var a=document.getElementsByClassName("bg-loader");if(a&&a.length)for(var b=0,c=a.length;c>b;b++)new background_loader(a[b])}}),new Script({pages:["channel"],call:function(){El("#channel-social-message-submit").on("click",postMessage),El("#post-content").on("keydown",function(a){13===a.keyCode&&a.ctrlKey&&postMessage()})}}),new Script({pages:["watch"],call:function(){if(!document.getElementById("embed-video-icon"))return!1;var a=El("#embed-video-icon");on(a,"CLICK",function(){var a=El("#video-info-description");a.has_class("export")?a.remove_class("export"):(a.add_class("export"),El("#exporter-input").select())}),El("#exporter-quality").on("change",set_exporter_input_value),El("#exporter-autoplay").on("change",set_exporter_input_value),El("#exporter-time-checkbox").on("change",set_exporter_input_value),El("#exporter-time-input").on("change",set_exporter_input_value),set_exporter_input_value()}}),new Script({pages:["default","watch"],call:function(){}}),new Script({pages:["watch"],call:function(){if(!document.getElementById("share-video-icon"))return!1;var a=El("#share-video-icon");a.on("CLICK",function(){var a=El("#share-video-block"),b=El("#video-info-description");a.toogle_class("show"),b.toogle_class("little")})}}),new Script({call:function(){}});